Loading config from config/default.yaml...
✓ 配置已加载: config/default.yaml
Device: cuda
Seed: 42
Output directory: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0006
Checkpoints will be saved to: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0006/checkpoints_2
TensorBoard logs: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0006/runs

============================================================
Initializing DataLoaders...
============================================================
[DPDDDataset] Mode: train, Real samples: 350, Repeat factor: 100, Virtual length: 35000
[DPDDDataset] Mode: val, Real samples: 74, Repeat factor: 1, Virtual length: 74
✓ Train set: 350 real images, virtual length: 35000
✓ Val set size: 74
✓ Batch size: 1
✓ Crop size (train): 1024
✓ Center crop size (val): 1024

============================================================
Building Models...
============================================================
  ├─ 像差网络: AberrationNet (hidden_dim=512)
  ├─ 复原网络: RestorationNet (base_filters=96, use_coords=True)
  └─ 物理层: OLA (patch=128, stride=64, algo=Standard)

Initializing Trainer...
[TensorBoard] Logging to: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0006/runs

训练计划:
  Stage 1 (Physics Only):        Epochs 1-50
  Stage 2 (Restoration):         Epochs 51-250
  Stage 3 (Joint, LR halved):    Epochs 251-300
  Total: 300 epochs

============================================================
Start Training
============================================================
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /root/miniconda3/envs/defocus/lib/python3.10/site-packages/lpips/weights/v0.1/alex.pth

============================================================
Epoch 1/300 - Stage 1: Physics Only (物理层训练)
============================================================
