Loading config from config/default.yaml...
✓ 配置已加载: config/default.yaml
Device: cuda
Seed: 42
Output directory: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0857
Checkpoints will be saved to: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0857/checkpoints_2
TensorBoard logs: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0857/runs

============================================================
Initializing DataLoaders...
============================================================
[DPDDDataset] Mode: train, Real samples: 350, Repeat factor: 100, Virtual length: 35000
[DPDDDataset] Mode: val, Real samples: 74, Repeat factor: 1, Virtual length: 74
✓ Train set: 350 real images, virtual length: 35000
✓ Val set size: 74
✓ Batch size: 16
✓ Crop size (train): 1024
✓ Center crop size (val): 1024

============================================================
Building Models...
============================================================
  ├─ 像差网络: AberrationNet (hidden_dim=512)
  ├─ 复原网络: RestorationNet (base_filters=96, use_coords=True)
  └─ 物理层: OLA (patch=128, stride=64, algo=Standard)

Initializing Trainer...
[TensorBoard] Logging to: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0857/runs

训练计划:
  Stage 1 (Physics Only):        Epochs 1-50
  Stage 2 (Restoration):         Epochs 51-250
  Stage 3 (Joint, LR halved):    Epochs 251-300
  Total: 300 epochs

============================================================
Start Training
============================================================
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /root/miniconda3/envs/defocus/lib/python3.10/site-packages/lpips/weights/v0.1/alex.pth

============================================================
Epoch 1/300 - Stage 1: Physics Only (物理层训练)
============================================================
  Train Loss: 0.004494 (Data: 0.004462, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004096 |
| PSF_Smoothness | 1.5e-05  |
  ✓ New best Stage 1 model saved: Reblur_MSE=0.004096

Epoch 2/300 [physics_only]
  Train Loss: 0.004455 (Data: 0.004421, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004094 |
| PSF_Smoothness | 1.3e-05  |
  ✓ New best Stage 1 model saved: Reblur_MSE=0.004094

Epoch 3/300 [physics_only]
  Train Loss: 0.004442 (Data: 0.004410, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |   Value |
|----------------|---------|
| Reblur_MSE     | 0.00409 |
| PSF_Smoothness | 1.3e-05 |
  ✓ New best Stage 1 model saved: Reblur_MSE=0.004090

Epoch 4/300 [physics_only]
  Train Loss: 0.004443 (Data: 0.004412, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004093 |
| PSF_Smoothness | 1.3e-05  |

Epoch 5/300 [physics_only]
  Train Loss: 0.004441 (Data: 0.004410, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |   Value |
|----------------|---------|
| Reblur_MSE     | 0.00409 |
| PSF_Smoothness | 1.3e-05 |

Epoch 6/300 [physics_only]
  Train Loss: 0.004435 (Data: 0.004406, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004092 |
| PSF_Smoothness | 1.3e-05  |

Epoch 7/300 [physics_only]
  Train Loss: 0.004430 (Data: 0.004402, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004095 |
| PSF_Smoothness | 1.4e-05  |

Epoch 8/300 [physics_only]
  Train Loss: 0.004435 (Data: 0.004408, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004094 |
| PSF_Smoothness | 1.5e-05  |

Epoch 9/300 [physics_only]
  Train Loss: 0.004438 (Data: 0.004411, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |    Value |
|----------------|----------|
| Reblur_MSE     | 0.004093 |
| PSF_Smoothness | 2.1e-05  |

Epoch 10/300 [physics_only]
  Train Loss: 0.004426 (Data: 0.004400, Sup: 0.000000)
  Evaluating on validation set...
| Metric         |   Value |
|----------------|---------|
| Reblur_MSE     | 0.00409 |
| PSF_Smoothness | 1.5e-05 |
  ✓ Periodic checkpoint saved: /root/autodl-nas/Defocus_with_NewBP/experiments_2/dpdd_physics_driven_train_2_0209_0857/checkpoints_2/checkpoint_epoch010.pt

Epoch 11/300 [physics_only]
