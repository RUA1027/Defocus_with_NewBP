# =============================================================================
# 高分辨率实验配置
# High Resolution Experiment Configuration
# =============================================================================
# 用于处理大尺寸图像的配置

physics:
  n_modes: 15
  pupil_size: 64
  kernel_size: 65                # 更大的 PSF 核，适合强散焦
  oversample_factor: 2
  ref_wavelength: 550.0e-9
  wavelengths:
    - 620.0e-9
    - 550.0e-9
    - 450.0e-9

ola:
  patch_size: 256                # 更大的补丁
  stride: 128                    # 保持 50% 重叠
  pad_to_power_2: true
  use_newbp: true

aberration_net:
  n_coeffs: 15
  a_max: 3.0                     # 更大的像差范围
  type: "polynomial"
  polynomial:
    degree: 3                    # 更高阶多项式
  mlp:
    hidden_dim: 128              # 更大的隐层
    use_fourier: true
    fourier_scale: 10
    a_max_mlp: 4.0

restoration_net:
  n_channels: 3
  n_classes: 3
  base_filters: 64               # 标准容量
  bilinear: true
  use_coords: true

training:
  optimizer:
    type: "adamw"
    lr_restoration: 5.0e-5       # 更小的学习率
    lr_optics: 5.0e-6
    weight_decay: 0.01
  loss:
    lambda_sup: 1.0
    lambda_coeff: 0.005
    lambda_smooth: 0.02
  gradient_clip:
    restoration: 5.0
    optics: 1.0
  smoothness_grid_size: 32

data:
  batch_size: 32                  # 高分辨率时减小批大小
  image_height: 1024
  image_width: 1024
  num_workers: 8

experiment:
  name: "high_resolution"
  seed: 42
  device: "cuda"
  epochs: 100
  save_interval: 20
  log_interval: 5
  output_dir: "results/high_res"
